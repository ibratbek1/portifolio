<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Onlayn Soat Bozori — Premium & Smart Watch</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    :root {
      --bg: #f8f9fa;
      --text: #1a1a1a;
      --card: #ffffff;
      --accent: #d4a017;
      --accent-dark: #b58900;
      --gray: #6c757d;
      --border: #dee2e6;
      --danger: #dc3545;
    }
    [data-theme="dark"] {
      --bg: #0d1117;
      --text: #e6edf3;
      --card: #161b22;
      --accent: #f0c14b;
      --accent-dark: #e0b03b;
      --gray: #8b949e;
      --border: #30363d;
      --danger: #f85149;
    }
    * {
      margin:0; padding:0; box-sizing:border-box;
    }
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      transition: background 0.4s, color 0.4s;
    }
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 16px;
    }
    header {
      background: var(--card);
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    }
    .top-bar {
      background: var(--accent);
      color: #000;
      text-align: center;
      padding: 8px;
      font-weight: 500;
      font-size: 0.95rem;
    }
    nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 0;
    }
    .logo {
      font-size: 1.8rem;
      font-weight: 800;
      color: var(--accent);
      text-decoration: none;
    }
    .nav-links {
      display: flex;
      gap: 32px;
      align-items: center;
    }
    .nav-links a {
      color: var(--text);
      text-decoration: none;
      font-weight: 500;
      transition: color 0.2s;
    }
    .nav-links a:hover { color: var(--accent); }
    .icons {
      display: flex;
      gap: 24px;
      align-items: center;
    }
    .icon-btn {
      background: none;
      border: none;
      font-size: 1.3rem;
      cursor: pointer;
      color: var(--text);
      position: relative;
    }
    .cart-count {
      position: absolute;
      top: -8px;
      right: -10px;
      background: var(--danger);
      color: white;
      font-size: 0.65rem;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .search-box {
      flex: 1;
      max-width: 500px;
      margin: 0 40px;
      position: relative;
    }
    .search-box input {
      width: 100%;
      padding: 12px 16px 12px 48px;
      border: 1px solid var(--border);
      border-radius: 50px;
      font-size: 1rem;
      background: var(--bg);
      color: var(--text);
    }
    .search-box i {
      position: absolute;
      left: 18px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gray);
    }
    main { padding: 40px 0; }
    .hero {
      background: linear-gradient(135deg, #1e3a5f, #2a5298);
      color: white;
      text-align: center;
      padding: 100px 20px;
      border-radius: 16px;
      margin-bottom: 60px;
      position: relative;
      overflow: hidden;
    }
    .hero h1 {
      font-size: 3.8rem;
      margin-bottom: 16px;
      font-weight: 800;
    }
    .hero p {
      font-size: 1.4rem;
      max-width: 700px;
      margin: 0 auto 32px;
      opacity: 0.9;
    }
    .btn {
      display: inline-block;
      padding: 14px 36px;
      background: var(--accent);
      color: #000;
      text-decoration: none;
      border-radius: 50px;
      font-weight: 600;
      font-size: 1.1rem;
      transition: all 0.25s;
    }
    .btn:hover {
      background: var(--accent-dark);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(212,160,23,0.3);
    }
    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      margin-bottom: 40px;
      background: var(--card);
      padding: 16px;
      border-radius: 12px;
      border: 1px solid var(--border);
    }
    .filter-group select,
    .filter-group input {
      padding: 10px 14px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--bg);
      color: var(--text);
      min-width: 160px;
    }
    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 28px;
    }
    .product-card {
      background: var(--card);
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid var(--border);
      transition: all 0.25s ease;
      position: relative;
    }
    .product-card:hover {
      transform: translateY(-12px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    }
    .product-img-wrapper {
      height: 260px;
      background: #f1f3f5;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    .product-img-wrapper img {
      max-height: 240px;
      max-width: 90%;
      object-fit: contain;
      transition: transform 0.4s;
    }
    .product-card:hover img { transform: scale(1.08); }
    .badge {
      position: absolute;
      top: 12px;
      left: 12px;
      background: var(--danger);
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
    }
    .product-info {
      padding: 20px;
    }
    .brand {
      color: var(--accent);
      font-weight: 600;
      font-size: 0.95rem;
      margin-bottom: 6px;
    }
    .name {
      font-size: 1.15rem;
      margin-bottom: 8px;
      line-height: 1.35;
      height: 2.7em;
      overflow: hidden;
    }
    .price {
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--accent);
      margin: 12px 0 16px;
    }
    .actions {
      display: flex;
      gap: 12px;
    }
    .add-to-cart {
      flex: 1;
      background: var(--accent);
      color: #000;
      border: none;
      padding: 12px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
    }
    .quick-view {
      background: #e9ecef;
      color: #343a40;
      border: none;
      padding: 12px 16px;
      border-radius: 10px;
      cursor: pointer;
    }
    .pagination {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin: 60px 0 40px;
    }
    .page-btn {
      padding: 10px 18px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--card);
      color: var(--text);
      cursor: pointer;
    }
    .page-btn.active {
      background: var(--accent);
      color: #000;
      border-color: var(--accent);
    }
    /* Modal */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.65);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }
    .modal.active { display: flex; }
    .modal-content {
      background: var(--card);
      width: 90%;
      max-width: 1100px;
      border-radius: 16px;
      overflow: hidden;
      position: relative;
      max-height: 92vh;
      overflow-y: auto;
    }
    .modal-close {
      position: absolute;
      top: 16px;
      right: 20px;
      font-size: 2rem;
      cursor: pointer;
      color: var(--gray);
      z-index: 10;
    }
    .product-detail {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
      padding: 40px;
    }
    .detail-img {
      height: 500px;
      background: #f8f9fa;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 16px;
      overflow: hidden;
    }
    .detail-img img {
      max-height: 100%;
      max-width: 100%;
      object-fit: contain;
    }
    .detail-info h1 {
      font-size: 2.4rem;
      margin-bottom: 16px;
    }
    .detail-price {
      font-size: 2.6rem;
      font-weight: 800;
      color: var(--accent);
      margin: 24px 0;
    }
    .add-to-cart-detail {
      background: var(--accent);
      color: #000;
      border: none;
      padding: 18px 40px;
      font-size: 1.2rem;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 700;
      width: 100%;
      max-width: 320px;
      margin: 24px 0;
    }
    /* Cart modal */
    #cartModal .modal-content {
      max-width: 900px;
    }
    .cart-item {
      display: grid;
      grid-template-columns: 100px 1fr 140px 100px 60px;
      gap: 20px;
      align-items: center;
      padding: 16px 0;
      border-bottom: 1px solid var(--border);
    }
    .cart-img {
      width: 100px;
      height: 100px;
      object-fit: contain;
      background: #f1f3f5;
      border-radius: 8px;
    }
    .cart-total {
      font-size: 1.6rem;
      font-weight: 700;
      text-align: right;
      margin: 24px 0;
    }
    /* Dark mode switch */
    .theme-toggle {
      background: none;
      border: none;
      font-size: 1.4rem;
      cursor: pointer;
    }
    /* Login modal */
    #loginModal .modal-content {
      max-width: 480px;
      padding: 40px;
    }
    .form-group {
      margin-bottom: 20px;
    }
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }
    .form-group input {
      width: 100%;
      padding: 14px;
      border: 1px solid var(--border);
      border-radius: 10px;
      font-size: 1rem;
      background: var(--bg);
      color: var(--text);
    }
    .login-btn {
      width: 100%;
      padding: 16px;
      background: var(--accent);
      color: #000;
      border: none;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      margin-top: 12px;
    }
    footer {
      background: var(--card);
      border-top: 1px solid var(--border);
      padding: 60px 0 30px;
      margin-top: 80px;
      text-align: center;
      color: var(--gray);
    }
    @media (max-width: 1024px) {
      .product-detail { grid-template-columns: 1fr; }
      .detail-img { height: 400px; }
    }
    @media (max-width: 768px) {
      .nav-links { display: none; }
      .search-box { margin: 0 20px; max-width: 400px; }
      .hero h1 { font-size: 2.8rem; }
      .product-detail { padding: 24px; }
    }
  </style>
</head>
<body>

<div class="top-bar">Yangi yil chegirmasi — 40% gacha! Faqat bugun!</div>

<header>
  <div class="container">
    <nav>
      <a href="#" class="logo">SOAT.UZ</a>

      <div class="search-box">
        <i class="fas fa-search"></i>
        <input type="text" id="searchInput" placeholder="Rolex, Casio, Smart soat, ... qidiring">
      </div>

      <div class="nav-links">
        <a href="#">Barcha soatlar</a>
        <a href="#">Erkaklar</a>
        <a href="#">Ayollar</a>
        <a href="#">Smart</a>
        <a href="#">Premium</a>
      </div>

      <div class="icons">
        <button class="icon-btn theme-toggle" title="Dark/Light"><i class="fas fa-moon"></i></button>
        <button class="icon-btn" id="loginBtn"><i class="fas fa-user"></i></button>
        <button class="icon-btn" id="cartBtn">
          <i class="fas fa-shopping-cart"></i>
          <span class="cart-count" id="cartCount">0</span>
        </button>
      </div>
    </nav>
  </div>
</header>

<main class="container">

  <section class="hero">
    <h1>Eng yaxshi soatlar — bir joyda</h1>
    <p>Rolex, Casio, Apple Watch, Samsung, Orient, Seiko, Tissot, Hamilton va boshqa 150+ brendlar chegirmali narxlarda</p>
    <a href="#products" class="btn">Katalogni ko‘rish</a>
  </section>

  <section class="filters">
    <div class="filter-group">
      <select id="brandFilter">
        <option value="">Barcha brendlar</option>
        <option value="Rolex">Rolex</option>
        <option value="Casio">Casio</option>
        <option value="Apple">Apple</option>
        <option value="Samsung">Samsung</option>
        <option value="Orient">Orient</option>
        <option value="Seiko">Seiko</option>
        <option value="Tissot">Tissot</option>
        <option value="Hamilton">Hamilton</option>
        <option value="Citizen">Citizen</option>
        <option value="Garmin">Garmin</option>
      </select>
    </div>
    <div class="filter-group">
      <select id="priceFilter">
        <option value="">Narx bo‘yicha</option>
        <option value="0-500000">0 — 500 000 so‘m</option>
        <option value="500000-1500000">500 000 — 1 500 000 so‘m</option>
        <option value="1500000+">1 500 000 so‘mdan yuqori</option>
      </select>
    </div>
    <div class="filter-group">
      <select id="typeFilter">
        <option value="">Turi</option>
        <option value="classic">Klassik</option>
        <option value="smart">Smart</option>
        <option value="sport">Sport</option>
        <option value="luxury">Luxury</option>
      </select>
    </div>
  </section>

  <section id="products">
    <h2 style="margin-bottom:28px; font-size:2.2rem;">Barcha soatlar (168 ta)</h2>
    <div class="products-grid" id="productsGrid"></div>
  </section>

  <div class="pagination">
    <button class="page-btn">1</button>
    <button class="page-btn active">2</button>
    <button class="page-btn">3</button>
    <button class="page-btn">4</button>
    <button class="page-btn">...</button>
    <button class="page-btn">11</button>
  </div>

</main>

<footer>
  <div class="container">
    <p>© 2025–2026 SOAT.UZ — Onlayn soat bozori. Barcha huquqlar himoyalangan.</p>
    <p style="margin-top:12px;">Yetkazib berish: Butun O‘zbekiston bo‘ylab | To‘lov: Click, Payme, Uzcard, Humo</p>
  </div>
</footer>

<!-- Modallar -->

<div class="modal" id="quickViewModal">
  <div class="modal-content">
    <span class="modal-close" id="closeQuickView">×</span>
    <div class="product-detail" id="detailContent"></div>
  </div>
</div>

<div class="modal" id="cartModal">
  <div class="modal-content">
    <span class="modal-close" id="closeCart">×</span>
    <h2 style="margin:30px 40px 20px;">Savatcha (<span id="cartItemsCount">0</span>)</h2>
    <div style="padding:0 40px 40px;" id="cartItems"></div>
    <div style="padding:0 40px 40px; text-align:right;">
      <div class="cart-total">Jami: <span id="cartTotal">0 so‘m</span></div>
      <button class="btn" style="margin-top:20px; padding:16px 48px;">Rasmiylashtirishga o‘tish</button>
    </div>
  </div>
</div>

<div class="modal" id="loginModal">
  <div class="modal-content">
    <span class="modal-close" id="closeLogin">×</span>
    <h2 style="text-align:center; margin-bottom:32px;">Kirish / Ro‘yxatdan o‘tish</h2>
    
    <div class="form-group">
      <label>Telefon yoki email</label>
      <input type="text" placeholder="+998 __ ___ __ __ yoki name@example.com">
    </div>
    
    <div class="form-group">
      <label>Parol</label>
      <input type="password" placeholder="Parolingizni kiriting">
    </div>
    
    <button class="login-btn">Kirish</button>
    
    <p style="text-align:center; margin-top:24px;">
      Hisobingiz yo‘qmi? <a href="#" style="color:var(--accent);">Ro‘yxatdan o‘tish</a>
    </p>
  </div>
</div>

<script>
// ==================== MA'LUMOTLAR ====================
const watches = [
  { 
    id:1, 
    brand:"Rolex", 
    name:"Submariner Date 41mm", 
    price:145000000, 
    type:"luxury", 
    img:"https://img.chrono24.com/images/uhren/44189619-gou0smepfviybonjmvez3o8d-ExtraLarge.jpg", 
    isNew:true 
  },
  { 
    id:2, 
    brand:"Rolex", 
    name:"Datejust 36mm Silver", 
    price:98000000, 
    type:"luxury", 
    img:"https://watchchest.com/media/amasty/webp/catalog/product/cache/80fa0d800d61bcb937d25ad90f8e907f/r/o/rolex_datejust_36_116234_wristwatch_silver_dial_jubilee-1_jpg.webp" 
  },
  { 
    id:3, 
    brand:"Casio", 
    name:"G-Shock GA-2100 Skeleton", 
    price:1450000, 
    type:"sport", 
    img:"https://gr8sunglasses.com/cdn/shop/products/G-SHOCK_GA-2100SKE-7ADR-3.jpg?v=1736423307", 
    discount:15 
  },
  { 
    id:4, 
    brand:"Casio", 
    name:"Edifice EQB-1000", 
    price:4200000, 
    type:"sport", 
    img:"https://www.ablogtowatch.com/wp-content/uploads/2019/10/Casio-Edifice-EQB1000D-1A-Bluetooth-Watch-1.jpg" 
  },
  { 
    id:5, 
    brand:"Apple", 
    name:"Watch Ultra 2 Titanium", 
    price:14500000, 
    type:"smart", 
    img:"https://store.storeimages.cdn-apple.com/1/as-images.apple.com/is/refurb-49-cell-titanium-ocean-orange-ultra?wid=1200&hei=630&fmt=jpeg&qlt=95&.v=1709568073986" 
  },
  { 
    id:6, 
    brand:"Samsung", 
    name:"Galaxy Watch 7 44mm", 
    price:5200000, 
    type:"smart", 
    img:"https://image-us.samsung.com/us/galaxy-watch7/gallery/SCOMB6Q6-59-SM-L310_001_Front_Green-1600x1200.jpg?$product-details-jpg$" 
  },
  { 
    id:7, 
    brand:"Orient", 
    name:"Bambino Classic", 
    price:1850000, 
    type:"classic", 
    img:"https://hodinkee-production.s3.amazonaws.com/uploads/images/59e543b5-c219-4114-9be9-282428ca4a8e/L1090340.jpg" 
  },
  { 
    id:8, 
    brand:"Seiko", 
    name:"Presage Cocktail Time", 
    price:3200000, 
    type:"classic", 
    img:"https://pic.watchclicker.com/wp-content/uploads/2020/09/18142537/seiko-cocktail-time-srpb41-13-1920x1024.jpg" 
  },
  { 
    id:9, 
    brand:"Tissot", 
    name:"PRX Powermatic 80", 
    price:5200000, 
    type:"luxury", 
    img:"https://hodinkee.imgix.net/uploads/images/9b38a9ca-f8c5-462e-964c-1d8787b8861d/tissot_prx_hodinkee_2880.jpg?ixlib=rails-1.1.0&fm=jpg&q=55&auto=format&usm=12" 
  },
  { 
    id:10, 
    brand:"Hamilton", 
    name:"Khaki Field Auto", 
    price:3800000, 
    type:"sport", 
    img:"https://m.media-amazon.com/images/I/71RyPbSa7dL._AC_UY900_.jpg" 
  },
  // Qo'shimcha 10 ta haqiqiy model (11-20)
  { 
    id:11, 
    brand:"Rolex", 
    name:"Daytona Panda 116500LN", 
    price:320000000, 
    type:"luxury", 
    img:"https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe1d862e8-2402-4b4f-8bfc-77e4f5da5315_1530x820.png" 
  },
  { 
    id:12, 
    brand:"Seiko", 
    name:"Prospex Turtle SRP777", 
    price:2800000, 
    type:"sport", 
    img:"https://hodinkee.imgix.net/uploads/images/1455658527727-kljqdh6ybji0y66r-4b08511b4221a918d40f0fa82446124c/seiko_srp_turtle_hero.jpg?ixlib=rails-1.1.0&fm=jpg&q=55&auto=format&usm=12" 
  },
  { 
    id:13, 
    brand:"Rolex", 
    name:"Submariner No-Date 41mm", 
    price:130000000, 
    type:"luxury", 
    img:"https://luxurytimenyc.com/cdn/shop/files/0_86bf5445-e098-4c98-af02-82473f06fe21_1024x1024@2x.jpg?v=1755099417" 
  },
  { 
    id:14, 
    brand:"Casio", 
    name:"G-Shock GA-2100 Clear", 
    price:1400000, 
    type:"sport", 
    img:"https://otokomaeken.com/wp-content/uploads/2024/06/adb415830393e16565013dcf903507fb-750x396.jpg" 
  },
  { 
    id:15, 
    brand:"Apple", 
    name:"Watch Ultra 2 Titanium Orange", 
    price:14500000, 
    type:"smart", 
    img:"https://sm.pcmag.com/pcmag_me/photo/default/05u2a75alpzlukciehynqqd-20_rqbz.jpg" 
  },
  { 
    id:16, 
    brand:"Samsung", 
    name:"Galaxy Watch 7 44mm Green", 
    price:5200000, 
    type:"smart", 
    img:"https://cdn.mos.cms.futurecdn.net/7vBWqR7YmxhZ8GXJvnJtgf.jpg" 
  },
  { 
    id:17, 
    brand:"Orient", 
    name:"Bambino Version 2", 
    price:1900000, 
    type:"classic", 
    img:"https://dappered.com/wp-content/uploads/2024/08/Orient-Small-Seconds-38mm-Bambino-reflection-header-1500.jpg" 
  },
  { 
    id:18, 
    brand:"Seiko", 
    name:"Presage Cocktail Time Blue", 
    price:3200000, 
    type:"classic", 
    img:"https://miro.medium.com/v2/resize:fit:1200/1*qV4adC7nDNApUT9z05gMQg.jpeg" 
  },
  { 
    id:19, 
    brand:"Tissot", 
    name:"PRX Powermatic 80 Green", 
    price:5300000, 
    type:"luxury", 
    img:"https://hodinkee-production.s3.amazonaws.com/uploads/images/9731052e-e6a7-4e19-8c95-c99adb7a1731/L1100530.jpg" 
  },
  { 
    id:20, 
    brand:"Hamilton", 
    name:"Khaki Field Auto 38mm", 
    price:3800000, 
    type:"sport", 
    img:"https://content.abt.com/image.php/Hamilton-Khaki-Field-Auto-38mm-Watch-H70455733.jpg?image=/images/products/BDP_Images/Hamilton-Khaki-Field-Auto-38mm-Watch-H70455733.jpg&canvas=1&width=750&height=550" 
    
  } 
];

// 21-dan 168-gacha random soatlar (haqiqiy rasmlar bilan to'ldirish qiyin bo'lgani uchun placeholder)
for(let i=21; i<=168; i++){
  watches.push({
    id: i,
    brand: ["Rolex","Casio","Apple","Samsung","Orient","Seiko","Tissot","Hamilton","Citizen","Garmin"][Math.floor(Math.random()*10)],
    name: "Model "+i+" Premium",
    price: Math.floor(Math.random()*140000000 + 800000),
    type: ["luxury","classic","sport","smart"][Math.floor(Math.random()*4)],
    img: `https://picsum.photos/800/800?random=${i}`,
    discount: Math.random()>0.8 ? Math.floor(Math.random()*25)+5 : 0
  });
}

// ==================== STATE ====================
let cart = [];
let currentDetail = null;

// ==================== DOM ELEMENTLARI ====================
const productsGrid = document.getElementById("productsGrid");
const searchInput = document.getElementById("searchInput");
const brandFilter = document.getElementById("brandFilter");
const priceFilter = document.getElementById("priceFilter");
const typeFilter = document.getElementById("typeFilter");
const cartCountEl = document.getElementById("cartCount");
const cartItemsEl = document.getElementById("cartItems");
const cartTotalEl = document.getElementById("cartTotal");
const cartItemsCountEl = document.getElementById("cartItemsCount");

// ==================== RENDER ====================
function renderProducts(filtered = watches) {
  productsGrid.innerHTML = "";
  filtered.forEach(w => {
    const card = document.createElement("div");
    card.className = "product-card";
    card.innerHTML = `
      ${w.isNew ? '<span class="badge" style="background:#28a745">YANGI</span>' : ''}
      ${w.discount ? `<span class="badge" style="left:auto;right:12px;background:#dc3545">-${w.discount}%</span>` : ''}
      <div class="product-img-wrapper">
        <img src="${w.img}" alt="${w.name}">
      </div>
      <div class="product-info">
        <div class="brand">${w.brand}</div>
        <div class="name">${w.name}</div>
        <div class="price">
          ${w.discount 
            ? `<s style="color:var(--gray);font-size:1rem;">${(w.price).toLocaleString()} so‘m</s><br>${Math.round(w.price * (1 - w.discount/100)).toLocaleString()} so‘m`
            : `${w.price.toLocaleString()} so‘m`}
        </div>
        <div class="actions">
          <button class="add-to-cart" data-id="${w.id}">Savatchaga</button>
          <button class="quick-view" data-id="${w.id}">Batafsil</button>
        </div>
      </div>
    `;
    productsGrid.appendChild(card);
  });
}

// ==================== FILTER & SEARCH ====================
function filterProducts() {
  let filtered = [...watches];

  // Qidiruv
  const query = searchInput.value.toLowerCase().trim();
  if(query) {
    filtered = filtered.filter(w => 
      w.name.toLowerCase().includes(query) || 
      w.brand.toLowerCase().includes(query)
    );
  }

  // Brand
  const brand = brandFilter.value;
  if(brand) filtered = filtered.filter(w => w.brand === brand);

  // Narx
  const priceRange = priceFilter.value;
  if(priceRange){
    if(priceRange === "0-500000") filtered = filtered.filter(w => w.price <= 500000);
    else if(priceRange === "500000-1500000") filtered = filtered.filter(w => w.price > 500000 && w.price <= 1500000);
    else if(priceRange === "1500000+") filtered = filtered.filter(w => w.price > 1500000);
  }

  // Tur
  const type = typeFilter.value;
  if(type) filtered = filtered.filter(w => w.type === type);

  renderProducts(filtered);
}

// ==================== SAVAT ====================
function updateCart() {
  cartItemsEl.innerHTML = "";
  let total = 0;

  cart.forEach(item => {
    const watch = watches.find(w => w.id === item.id);
    if(!watch) return;
    const sum = watch.price * item.qty;
    total += sum;

    const div = document.createElement("div");
    div.className = "cart-item";
    div.innerHTML = `
      <img src="${watch.img}" class="cart-img" alt="">
      <div>
        <div style="font-weight:600">${watch.brand} ${watch.name}</div>
        <div style="color:var(--gray);font-size:0.9rem;">${watch.price.toLocaleString()} so‘m</div>
      </div>
      <div style="text-align:center">
        <button class="qty-btn" data-id="${item.id}" data-action="dec">-</button>
        ${item.qty}
        <button class="qty-btn" data-id="${item.id}" data-action="inc">+</button>
      </div>
      <div style="font-weight:600;text-align:right">${sum.toLocaleString()} so‘m</div>
      <button class="remove-btn" data-id="${item.id}">×</button>
    `;
    cartItemsEl.appendChild(div);
  });

  cartCountEl.textContent = cart.reduce((s,i)=>s+i.qty,0);
  cartItemsCountEl.textContent = cart.length;
  cartTotalEl.textContent = total.toLocaleString() + " so‘m";
}

// ==================== DETAIL MODAL ====================
function showDetail(id) {
  const w = watches.find(x => x.id === id);
  if(!w) return;

  currentDetail = w;

  document.getElementById("detailContent").innerHTML = `
    <div class="detail-img">
      <img src="${w.img}" alt="${w.name}">
    </div>
    <div class="detail-info">
      <div style="color:var(--accent);font-weight:600">${w.brand}</div>
      <h1>${w.name}</h1>
      <div class="detail-price">${w.price.toLocaleString()} so‘m</div>
      <p style="line-height:1.7;color:var(--gray);margin:20px 0;">
        • Avtomatik mexanizm<br>
        • Sapphire shisha<br>
        • 100 m suv o‘tkazmaslik<br>
        • 2 yillik kafolat<br>
        • Dunyo bo‘ylab yetkazib berish
      </p>
      <button class="add-to-cart-detail" data-id="${w.id}">Savatchaga qo‘shish</button>
      <div style="margin-top:40px;">
        <strong>Yetkazib berish:</strong> 1-3 kun ichida (Toshkent)<br>
        <strong>To‘lov:</strong> Click, Payme, Uzcard, naqd
      </div>
    </div>
  `;

  document.getElementById("quickViewModal").classList.add("active");
}

// ==================== EVENT LISTENERS ====================
document.addEventListener("click", e => {
  const t = e.target;

  // Savatchaga qo'shish
  if(t.classList.contains("add-to-cart") || t.classList.contains("add-to-cart-detail")) {
    const id = Number(t.dataset.id);
    const found = cart.find(c => c.id === id);
    if(found) found.qty++;
    else cart.push({id, qty:1});
    updateCart();
  }

  // Batafsil ko'rish
  if(t.classList.contains("quick-view")) {
    showDetail(Number(t.dataset.id));
  }

  // Modal yopish
  if(t.classList.contains("modal-close") || t.classList.contains("modal")) {
    t.closest(".modal").classList.remove("active");
  }

  // Savatdan o'chirish
  if(t.classList.contains("remove-btn")) {
    const id = Number(t.dataset.id);
    cart = cart.filter(c => c.id !== id);
    updateCart();
  }

  // Miqdor o'zgartirish
  if(t.classList.contains("qty-btn")) {
    const id = Number(t.dataset.id);
    const action = t.dataset.action;
    const item = cart.find(c => c.id === id);
    if(item) {
      if(action === "inc") item.qty++;
      if(action === "dec" && item.qty > 1) item.qty--;
      if(action === "dec" && item.qty === 1) cart = cart.filter(c => c.id !== id);
      updateCart();
    }
  }
});

// Qidiruv va filtrlar
searchInput.addEventListener("input", filterProducts);
brandFilter.addEventListener("change", filterProducts);
priceFilter.addEventListener("change", filterProducts);
typeFilter.addEventListener("change", filterProducts);

// Login / Cart ochish
document.getElementById("loginBtn").onclick = () => document.getElementById("loginModal").classList.add("active");
document.getElementById("cartBtn").onclick  = () => document.getElementById("cartModal").classList.add("active");

// Dark mode
document.querySelector(".theme-toggle").onclick = () => {
  const current = document.body.dataset.theme;
  document.body.dataset.theme = current === "dark" ? "" : "dark";
  document.querySelector(".theme-toggle i").className = current === "dark" ? "fas fa-moon" : "fas fa-sun";
};

// Dastlabki yuklash
renderProducts();
updateCart();

</script>
</body>
</html>